---
import { actions, isInputError } from "astro:actions";

interface Props {
	postSlug: string;
}

const { postSlug } = Astro.props;

const result = Astro.getActionResult(actions.addComment);
const inputErrors = isInputError(result?.error) ? result.error.fields : {};
---

<form
	method="POST"
	action={actions.addComment}
	class="bg-base-50 border-base-200 mb-8 rounded-lg border p-6 shadow-sm"
>
	<h3 class="text-base-900 mb-4 text-xl font-bold">Leave a Comment</h3>
	<input type="hidden" name="postSlug" value={postSlug} />

	<div class="mb-4">
		<label for="name" class="text-base-700 mb-1 block font-medium">Name</label>
		<input
			type="text"
			id="name"
			name="name"
			required
			placeholder="Your Name"
			class="border-base-300 text-base-900 focus:border-primary-500 focus:ring-primary-500 w-full rounded-md border bg-white p-2 focus:ring-1 focus:outline-none"
		/>
		{inputErrors.name && <p class="text-error mt-1 text-sm">{inputErrors.name}</p>}
	</div>

	<div class="mb-4">
		<label for="email" class="text-base-700 mb-1 block font-medium">Email</label>
		<input
			type="email"
			id="email"
			name="email"
			required
			placeholder="your@email.com"
			class="border-base-300 text-base-900 focus:border-primary-500 focus:ring-primary-500 w-full rounded-md border bg-white p-2 focus:ring-1 focus:outline-none"
		/>
		{inputErrors.email && <p class="text-error mt-1 text-sm">{inputErrors.email}</p>}
	</div>

	<div class="mb-4">
		<label for="message" class="text-base-700 mb-1 block font-medium">Comment</label>
		<textarea
			id="message"
			name="message"
			required
			rows="4"
			placeholder="Shared your thoughts..."
			class="border-base-300 text-base-900 focus:border-primary-500 focus:ring-primary-500 w-full rounded-md border bg-white p-2 focus:ring-1 focus:outline-none"
		></textarea>
		{inputErrors.message && <p class="text-error mt-1 text-sm">{inputErrors.message}</p>}
	</div>

	<button
		type="submit"
		class="bg-primary-600 hover:bg-primary-700 focus:ring-primary-500 rounded-md px-6 py-2.5 font-medium text-white transition focus:ring-2 focus:ring-offset-2 focus:outline-none"
	>
		Add Comment
	</button>
</form>
