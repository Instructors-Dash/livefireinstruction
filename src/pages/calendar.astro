---
import IframeComponent from "@/components/IframeComponent/IframeComponent.astro";
import PageHeader from "@/components/PageHeader/PageHeader.astro";
import siteData from "@/config/siteData.json";
import BaseLayout from "@layouts/BaseLayout.astro";
import { getKeystaticReader } from "@/lib/keystatic-reader";
import { schemaGenerators } from "@/utils/schema";

const reader = getKeystaticReader();
const calendar = await reader.singletons.calendar.read();
const pageTitle = calendar?.pageTitle || "Course Calendar";
const iframeUrl = calendar?.iframeUrl;
const iframeHeight = calendar?.iframeHeight;
const iframeWidth = calendar?.iframeWidth;

const schemaData = schemaGenerators.calendar({
	name: calendar?.pageTitle || "Course Calendar",
	description: siteData.description,
	url: Astro.url.href,
});
---

<BaseLayout
	title={pageTitle + " - " + siteData.title}
	description={siteData.description}
	schemaType="calendar"
	schemaData={schemaData}
>
	<PageHeader title={pageTitle}>
		<hr class="bg-primary-600/50 mx-auto mt-4 max-w-[30%] rounded-full border-none pt-1" />
	</PageHeader>
	<section class="site-container px-4 py-16">
		<IframeComponent height={iframeHeight} width={iframeWidth} src={iframeUrl} />
	</section>
</BaseLayout>
